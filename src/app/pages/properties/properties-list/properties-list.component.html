<div class="ui-page">
  <div class="ui-page-header">
    <div class="ui-title">
      <h1>Propriedades</h1>
      <p class="ui-muted">Gerencie as propriedades cadastradas e seus canais conectados.</p>
    </div>

    <div class="ui-actions">
      <button class="ui-btn primary solid" type="button" (click)="goNew()">
        <span class="material-symbols-rounded">add</span>
        Nova propriedade
      </button>
    </div>
  </div>

  <app-table-card title="Propriedades cadastradas" [hasRows]="rows().length > 0" [loading]="loading()"
    [hasFilters]="true">
    <!-- Filtros -->
    <div tableFilters>
      <div class="ui-subcard-head">
        <div class="ui-sub-title">Filtros</div>

        <button class="ui-btn ghost mini" type="button" (click)="clearFilters()">
          Limpar
        </button>
      </div>

      <div class="ui-filters" [formGroup]="filterForm">
        <div class="ui-field grow">
          <label>Buscar</label>
          <input formControlName="q" placeholder="Nome, cidade..." />
        </div>

        <div class="ui-field">
          <label>País</label>
          <select formControlName="country">
            <option value="">Todos</option>
            <option value="BR">Brasil</option>
            <option value="US">Estados Unidos</option>
            <option value="PT">Portugal</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Conteúdo da tabela -->
    <div tableContent>
      <table class="ui-table">
        <thead>
          <tr>
            <th>Nome</th>
            <th style="width: 220px;">Local</th>
            <th style="width: 90px;">País</th>
            <th style="width: 120px;">Status</th>
            <th class="ui-right" style="width: 140px;">Criada em</th>
            <th class="ui-right" style="width: 160px;">Ações</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let property of rows()" [class.ui-row-inactive]="!property.active">
            <td class="ui-td-strong">{{ property.name }}</td>

            <td class="ui-td-muted">
              {{ property.city }}<span *ngIf="property.state"> - {{ property.state }}</span>
            </td>

            <td class="ui-td-muted">{{ property.country }}</td>

            <td>
              <span class="ui-badge" [class.success]="property.active" [class.warning]="!property.active">
                {{ property.active ? 'Ativa' : 'Inativa' }}
              </span>
            </td>

            <td class="ui-right ui-td-muted">
              {{ property.createdAt | date:'dd/MM/yyyy' }}
            </td>

            <td class="ui-right ui-actions-cell">
              <button class="ui-icon-btn" title="Editar" type="button" (click)="edit(property.publicId)">
                <span class="material-symbols-rounded">edit</span>
              </button>

              <button class="ui-icon-btn warning" title="Ativar/Inativar" type="button"
                (click)="toggleActive(property)">
                <span class="material-symbols-rounded">
                  {{ property.active ? 'pause_circle' : 'play_circle' }}
                </span>
              </button>

              <button class="ui-icon-btn danger" title="Excluir" type="button" (click)="remove(property)">
                <span class="material-symbols-rounded">delete</span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </app-table-card>
</div>